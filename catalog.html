<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Product Flyers</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <iframe name="hiddenFrame" style="display:none;"></iframe>

  <header class="header">
    <div class="logo-nav-container">
      <img src="images/FOB-Logo.png" alt="Northwest Logo" class="logo" />

      <div class="search-wrapper">
        <div class="search-container">
          <input type="text" id="portalSearch" placeholder="Search materials..." />
        </div>

        <nav class="navbar"> 
          <a href="catalog.html">All Materials</a>
          <a href="door-hangers.html">Door Hangers</a>
          <a href="leave-behinds.html">Leave Behinds</a>
          <a href="event-materials.html">Event Materials</a>
          <a href="flyers.html">Flyers</a>
          <a href="takeover.html">Takeover Cards</a>
          <a href="thank-you-cards.html">Thank You Cards</a>
          <a href="faq.html">FAQ</a>
          <a href="contact.html">Contact Us</a>
        </nav>
      </div>
    </div>

    <!-- ðŸ”’ User login bar -->
    <div class="user-controls" style="text-align:right; padding:10px 20px;">
      <span id="userEmail" style="margin-right:12px; font-weight:500; color:#333;"></span>
      <button id="logout-btn" style="
        background-color:#85C446;
        border:none;
        color:white;
        font-weight:bold;
        border-radius:8px;
        padding:8px 14px;
        cursor:pointer;
        display:none;
      ">
        Sign Out
      </button>
    </div>
  </header>

  <section class="hero-banner">
    <h1 class="hero-title">Marketing Material Portal</h1>
  </section>

  <section class="feature-section" id="featureSection" aria-expanded="false">
    <div class="feature-content">
      <div class="feature-text-card">
        <h2>
          <a href="#" class="feature-title-link" id="featureToggle" role="button" aria-controls="featureDetails" aria-expanded="false">
            Which Marketing Material Fits Your Moment?
          </a>
        </h2>
        <div class="feature-details">
          <p><strong>Door Hangers (3.5x8.5")</strong><br> Designed with your clover leafing strategy in mind.</p>
          <p><strong>Flyers (8.5x11")</strong><br> The largest way to share your services. Perfect for community boards, commercial leave-behinds, and high-impact messaging.</p>
          <p><strong>Leave Behinds (4x9")</strong><br> Designed for in-person connection and extraordinary events. A friendly, sleek way to continue the conversation.</p>
          <p><strong>Takeover Cards (3x5")</strong><br> Share $25 discounts to new customers at events.</p>
          <p><strong>Thank You Cards (3x5")</strong><br> A kind word goes a long way. Use these to show appreciation for your community or teammates.</p>
        </div>
      </div>
    </div>
  </section>

  <main class="product-grid">

    <!-- ðŸ‘• Nike Polo Product -->
    <div class="product-card">
      <h2 class="product-title">Nike Dri-FIT Polo (NK1963)</h2>
      <img src="images/Nike Polo.jpg" alt="Northwest Nike Polo" class="flyer-thumb" />

      <div class="product-details">
        <form 
          action="https://hooks.zapier.com/hooks/catch/12716030/um5yedq/" 
          method="POST" 
          target="hiddenFrame" 
          onsubmit="handleFormSubmit(event)">
          <input type="text" name="fullName" placeholder="Manager Name" required />
          <input type="email" name="email" placeholder="Manager Email" required />
          <select name="Quantity" required>
            <option value="" disabled selected>Select Quantity</option>
            <option value="25">25</option>
            <option value="50">50</option>
            <option value="100">100</option>
          </select>
          <select name="office" required>
            <option value="" disabled selected>Select Office</option>
            <option value="Acworth - NWST">Acworth - NWST</option>
            <option value="Marietta - NWST">Marietta - NWST</option>
            <option value="Peachtree Corners - NWST">Peachtree Corners - NWST</option>
            <option value="Team Support Center - NWST">Team Support Center - NWST</option>
          </select>
          <input type="hidden" name="product" value="Nike Polo Order" />
          <button type="submit" class="button">Request</button>
        </form>

        <p id="successMessage" style="display:none; color:green; margin-top:10px;">
          ðŸ¥³ Stay tuned for an email confirmation!
        </p>
      </div>

      <p>Official Nike Dri-FIT polo embroidered with the Northwest logo â€” designed for comfort, class, and service excellence.</p>
      <a 
        href="https://buy.stripe.com/4gM14oeihaaDfoIdUF8Ra03" 
        target="_blank" 
        class="button"
        id="polo-link">
        Buy Now
      </a>
    </div>
  </main>

  <script>
    // --- Product & Search Handling ---
    document.addEventListener('DOMContentLoaded', () => {
      const checkboxes = Array.from(document.querySelectorAll('.expand-checkbox'));

      function updateScrollLock() {
        const anyOpen = checkboxes.some(cb => cb.checked);
        document.body.classList.toggle('modal-open', anyOpen);
      }

      checkboxes.forEach(cb => cb.addEventListener('change', updateScrollLock));

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          checkboxes.forEach(cb => cb.checked = false);
          updateScrollLock();
        }
      });

      const search = document.getElementById('portalSearch');
      if (search) {
        search.addEventListener('input', function () {
          const q = this.value.toLowerCase();
          document.querySelectorAll('.product-card').forEach(card => {
            const title = (card.querySelector('.product-title')?.textContent || '').toLowerCase();
            card.style.display = title.includes(q) ? 'block' : 'none';
          });
        });
      }

      window.handleFormSubmit = function(e) {
        e.preventDefault();
        const form = e.target;
        form.submit();
        form.reset();
        const msg = form.closest('.product-details').querySelector('#successMessage');
        if (msg) {
          msg.style.display = 'block';
          setTimeout(() => (msg.style.display = 'none'), 2000);
        }
        setTimeout(() => {
          window.location.href = 'success.html';
        }, 2500);
      };
    });
  </script>

  <!-- ðŸ”’ Auth + Email Prefill Integration -->
  <script type="module" src="/scripts/auth.js"></script>
  <script type="module">
    import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js";
    import { auth } from "/scripts/auth.js";

    onAuthStateChanged(auth, (user) => {
      if (user) {
        const poloLink = document.getElementById("polo-link");
        if (poloLink) {
          poloLink.href = `https://buy.stripe.com/4gM14oeihaaDfoIdUF8Ra03?prefilled_email=${encodeURIComponent(user.email)}`;
        }
      }
    });
  </script>

</body>
</html>
